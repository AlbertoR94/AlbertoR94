<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>RFM analysis and customer segmentation with Python | Alberto Ruiz</title> <meta name="author" content="Alberto Ruiz"> <meta name="description" content="This is a project that uses RFM analysis for customer segmentation and statistical models to forecast customer future purchase behavior."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://albertor94.github.io/projects/1_project/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Alberto </span>Ruiz</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/projects/">projects</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">RFM analysis and customer segmentation with Python</h1> <p class="post-description">This is a project that uses RFM analysis for customer segmentation and statistical models to forecast customer future purchase behavior.</p> </header> <article> <h2 id="introduction">Introduction</h2> <p>It is clear that customers are one of the most important assets of any business and therefore is very important to understand their needs and preferences. If a company has access to relevant information about customer behavior it makes sense to use this information for marketing purposes. For example, we can split customers into different groups according to their purchase patterns; then, use this groups to make special offers or make other business-related decisions. Also, we can use past data to try to forecast the future behavior of customer in order to calculate the customer lifetime value. This will be important if we want to know whether we should spend effort in trying to retain a customer or not.</p> <p>In this project I present a RFM analysis that aims to segment a collection of customers into groups of similar purchase patterns. Also I apply a probability model to forecast the future expected behavior (in term of transactions) which can be used as an estimate of customer lifetime value. Finally I present the results in an interactive dashboard.</p> <p>The dataset used in this project can be found here: <a href="https://archive.ics.uci.edu/ml/datasets/online+retail" rel="external nofollow noopener" target="_blank">UCI repository</a>. This dataset, that belongs to an anonymous non-store online retail company, consists of several records with information about the transactions made by approximately 4000 customers between 01/12/2010 and 09/12/2011.</p> <h2 id="what-is-rfm-analysis">What is RFM analysis?</h2> <p>RFM stands for recency, frequency and monetary value and it is a behavior-based marketing technique which uses past transactional data to perform customer segmentation into groups of individuals with similar transactional patterns. Other customer segmentation techniques can be based on demographic, psychographic or geographic characteristics; however, any company that keeps a record of its customers transactions can make use of this type of technique.</p> <p>To perform a RFM analysis, we use transactional data to compute the recency (days since last purchase or transaction), frequency (total number of transactions) and monetary value (total money spent) for the considered period of time. In Figure 1 I show a capture of the first five records in the Pandas dataframe. Note that for each transaction we have information such as its unique identifier, the ID of the corresponding customer, date in which the transaction was made, etc. Given this information we can calculate all these quantities for each one of the customers.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/customersDF-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/customersDF-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/customersDF-1400.webp"></source> <img src="/assets/img/customersDF.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 1: Dataset containing transactional data. </div> <p>This calculation can be performed directly using Pandas but in this case I’m going to be using a Python library that is specifically designed for analyzing transactional data. This library is called Lifetimes and the documentation can be found here <a href="https://lifetimes.readthedocs.io/en/latest/" rel="external nofollow noopener" target="_blank">docs</a>. However, before doing such analysis, the first step is cleaning and preprocessing data to exclude missing values or rows that are not suitable for analysis. The detailed cleaning process can be seen in the accompanying notebook <a href="https://github.com/AlbertoR94/Python-RFM-analysis-" rel="external nofollow noopener" target="_blank">RFM</a>, but for the purposes of this report is enough to say that all transaction with no known customer were removed, as well as transactions associated to canceled orders.</p> <p>Given the preprocessed dataset we can proceed to perform the calculation of the RFM quantities. This can be done with the following function which accepts as input the whole transactional data an returns a dataframe where each record represents a customer and the corresponding recency, frequency and monetary value. For a definition of these quantities consult the documentation.</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
</pre></td> <td class="code"><pre><span class="kn">import</span> <span class="n">lifetimes</span> <span class="k">as</span> <span class="n">lt</span>

<span class="n">rfm</span> <span class="o">=</span> <span class="n">lt</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="nf">summary_data_from_transaction_data</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="sh">"</span><span class="s">CustomerID</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">InvoiceDate</span><span class="sh">"</span><span class="p">,</span> 
                                                  <span class="sh">"</span><span class="s">Total</span><span class="sh">"</span><span class="p">,</span> <span class="n">observation_period_end</span><span class="o">=</span><span class="sh">'</span><span class="s">2011-12-31</span><span class="sh">'</span><span class="p">)</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>The resulting dataframe is the following:</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/rfm-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/rfm-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/rfm-1400.webp"></source> <img src="/assets/img/rfm.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 2: Dataframe containing customers information. </div> <p>Once we have calculated these measures it is time to split the base of customers into groups with similar purchase patterns. This can be done in many ways, including machine learning techniques such as K-means Clustering or Gaussian Mixtures Models, but in this case we will follow a simpler approach that consists in dividing customers into a set of n quantiles according to the distribution of values for recency, frequency, and monetary value. Here we choose n=4 so there is a total of 4x4x4 possible groups. The interpretation of these groups is straightforward; for example, the customers in group (4,4,4) are the best since they bought recently, frequently and spent the most. On the contrary, customers belonging to group (1,1,1) are the worst since they bought a long time ago, infrequently and spent a little. The following code takes care of the quartile calculation:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
</pre></td> <td class="code"><pre><span class="n">rfm</span><span class="p">[</span><span class="sh">'</span><span class="s">r_category</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">qcut</span><span class="p">(</span><span class="n">rfm</span><span class="p">[</span><span class="sh">'</span><span class="s">recency</span><span class="sh">'</span><span class="p">],</span> <span class="n">q</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">duplicates</span><span class="o">=</span><span class="sh">'</span><span class="s">drop</span><span class="sh">'</span><span class="p">).</span><span class="nf">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">rfm</span><span class="p">[</span><span class="sh">'</span><span class="s">f_category</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">qcut</span><span class="p">(</span><span class="n">rfm</span><span class="p">[</span><span class="sh">'</span><span class="s">frequency</span><span class="sh">'</span><span class="p">],</span> <span class="n">q</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">duplicates</span><span class="o">=</span><span class="sh">'</span><span class="s">drop</span><span class="sh">'</span><span class="p">).</span><span class="nf">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">rfm</span><span class="p">[</span><span class="sh">'</span><span class="s">m_category</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">qcut</span><span class="p">(</span><span class="n">rfm</span><span class="p">[</span><span class="sh">'</span><span class="s">total_spent</span><span class="sh">'</span><span class="p">],</span> <span class="n">q</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)).</span><span class="nf">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>Note that the quartile corresponding to each measure is added as a new column for further analysis.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/rfm_2-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/rfm_2-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/rfm_2-1400.webp"></source> <img src="/assets/img/rfm_2.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 3: Dataframe containing customers information. </div> <h2 id="forecasting-customer-purchasing-patterns">Forecasting customer purchasing patterns.</h2> <p>In addition to customer segmentation, we can use customers past transactional data to forecast future purchase behavior. An important question at any point of time is whether a customer is still active and if this is the case how much value or revenue we can expect from her in the future. Assuming that past data can give us information about the future behavior of customers we can create probability models that capture the statistical transactional patterns and compute quantities of interest such as the probability of a customer being active, \(P(\textrm{Active} \lvert \textrm{Data})\), or the expected number of transactions \(X\) in a given period of time \(T\), \(E(X \lvert \textrm{Data},T)\). These quantities allow us to assess the potential of each customer in terms of the number of transactions that she will make in the future.</p> <p>In this report I will not explain the details of these models but present how we can construct them using Python and the Lifetimes library. For a detailed explanation of these type of models the interested reader can consult the references <d-cite key="schmittlein1987counting"></d-cite>. In the following I will use a BG/NBD model which stands for Beta Geometric / Negative Binomial Distribution. The following code shows how we can train the model using past transactional data:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
</pre></td> <td class="code"><pre><span class="kn">from</span> <span class="n">lifetimes</span> <span class="kn">import</span> <span class="n">BetaGeoFitter</span>
<span class="c1"># This model require customer information such as frequency and recency
</span><span class="n">bgf</span> <span class="o">=</span> <span class="nc">BetaGeoFitter</span><span class="p">(</span><span class="n">penalizer_coef</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
<span class="n">bgf</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">rfm</span><span class="p">[</span><span class="sh">'</span><span class="s">frequency</span><span class="sh">'</span><span class="p">],</span> <span class="n">rfm</span><span class="p">[</span><span class="sh">'</span><span class="s">recency</span><span class="sh">'</span><span class="p">],</span> <span class="n">rfm</span><span class="p">[</span><span class="sh">'</span><span class="s">T</span><span class="sh">'</span><span class="p">])</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>Note that this model only takes into account the recency and frequency measures.</p> <p>Once we have trained the model, we can visualize the distribution of the probability of still being active or the expected number of transactions as a function of customer recency and frequency.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/graphs-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/graphs-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/graphs-1400.webp"></source> <img src="/assets/img/graphs.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 3: Dataframe containing customers information. </div> <p>Then, for each customer, we can compute the probability of being active and the expected number of transactions and add this information to the dataframe as new columns.</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td> <td class="code"><pre><span class="n">rfm</span><span class="p">[</span><span class="sh">'</span><span class="s">prob_alive</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">bgf</span><span class="p">.</span><span class="nf">conditional_probability_alive</span><span class="p">(</span><span class="n">rfm</span><span class="p">[</span><span class="sh">'</span><span class="s">frequency</span><span class="sh">'</span><span class="p">],</span> <span class="n">rfm</span><span class="p">[</span><span class="sh">'</span><span class="s">recency</span><span class="sh">'</span><span class="p">],</span> <span class="n">rfm</span><span class="p">[</span><span class="sh">'</span><span class="s">T</span><span class="sh">'</span><span class="p">])</span>
<span class="c1"># We can also predict the future number of transactions for the next N time periods
</span><span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
    <span class="n">rfm</span><span class="p">[</span><span class="sh">'</span><span class="s">predicted_purchases_</span><span class="sh">'</span> <span class="o">+</span> <span class="nf">str</span><span class="p">(</span><span class="n">T</span><span class="p">)]</span> <span class="o">=</span> <span class="n">bgf</span><span class="p">.</span><span class="nf">conditional_expected_number_of_purchases_up_to_time</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">rfm</span><span class="p">[</span><span class="sh">'</span><span class="s">frequency</span><span class="sh">'</span><span class="p">],</span>                                                      <span class="n">rfm</span><span class="p">[</span><span class="sh">'</span><span class="s">recency</span><span class="sh">'</span><span class="p">],</span> <span class="n">rfm</span><span class="p">[</span><span class="sh">'</span><span class="s">T</span><span class="sh">'</span><span class="p">]).</span><span class="nf">sort_values</span><span class="p">()</span>
    
</pre></td> </tr></tbody></table></code></pre></figure> <p>The segmentation of customers into groups and the computation of \(P(\textrm{Active} \lvert \textrm{Data})\) and \(E(X \lvert \textrm{Data},T)\) allow us to evaluate how much we can expect from an active customer in the future. The results obtained from this analysis can be used to make informed marketing decisions to better allocate resources and improve revenue. For easy access to this analysis we can load the information contained in the new dataframe in a dashboard. This way, we can easily consult the information associated with each customer.</p> <h2 id="tableau-dashboard">Tableau dashboard</h2> <iframe seamless="" frameborder="0" src="https://public.tableau.com/views/RFManalysis_16850252617450/Dashboard1?:embed=yes&amp;:display_count=yes&amp;:showVizHome=no" width="800" height="650" scrolling="yes"></iframe> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Alberto Ruiz. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>